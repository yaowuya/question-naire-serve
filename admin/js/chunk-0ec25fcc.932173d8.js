(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ec25fcc"],{"5c3a":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-form",{staticClass:"pl-5",attrs:{inline:!0,model:e.queryForm}},[n("el-form-item",{attrs:{label:"用户",prop:"question"}},[n("el-select",{staticClass:"w-100",attrs:{multiple:"",clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.queryForm.person,callback:function(t){e.$set(e.queryForm,"person",t)},expression:"queryForm.person"}},e._l(e.personList,(function(t){return n("el-option",{key:t._id,attrs:{label:t.name,value:t._id}},[n("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),e._v(" "),n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.role.chinese))])])})),1)],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"success"},on:{click:function(t){return t.stopPropagation(),e.search()}}},[e._v("查询")])],1)],1),e._v(" "),n("avue-crud",{ref:"crud",attrs:{data:e.data,option:e.option,page:e.page,"table-loading":e.loading},on:{"update:page":function(t){e.page=t},"size-change":e.sizeChange,"current-change":e.currentChange},scopedSlots:e._u([{key:"menu",fn:function(t){var r=t.row;return[n("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return t.stopPropagation(),e.detail(r)}}},[e._v("查看问卷")])]}}])}),e._v(" "),n("el-drawer",{attrs:{visible:e.drawerVisible,"with-header":!1,"destroy-on-close":!0,size:"50%"},on:{"update:visible":function(t){e.drawerVisible=t}}},[e.show?n("DashComponent",{attrs:{"person-id":e.personId,"person-name":e.personName}}):e._e()],1)],1)},s=[],a=(n("96cf"),n("1da1")),i=(n("ac6a"),n("7f7f"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"body"},[n("div",{attrs:{id:"answerDetail"}},[n("div",{staticClass:"body-container"},e._l(e.dataList,(function(t,r){return n("div",{key:r,staticClass:"body-bottom"},[n("el-row",{attrs:{type:"flex",justify:"center"}},[n("el-tag",{attrs:{type:"success",effect:"dark"}},[e._v(e._s(t.answerObj.question.name))]),e._v(" "),0===r?n("el-button",{staticClass:"export-btn",attrs:{type:"warning",round:"",size:"small"},on:{click:function(t){return t.stopPropagation(),e.exportPdf(t)}}},[e._v("导出")]):e._e()],1),e._v(" "),n("el-divider"),e._v(" "),n("el-row",{attrs:{type:"flex",justify:"space-around"}},[n("el-tag",{attrs:{type:"success"}},[e._v("问卷类型："+e._s(t.answerObj.questionType.chinese))]),e._v(" "),n("el-tag",{attrs:{type:"success"}},[e._v("姓名："+e._s(t.answerObj.person.name))]),e._v(" "),n("el-tag",{attrs:{type:"info"}},[e._v("身份："+e._s(t.answerObj.person.role.chinese))]),e._v(" "),n("el-tag",{attrs:{type:"warning"}},[e._v("填写时间："+e._s(t.answerObj.createTime))])],1),e._v(" "),n("el-divider"),e._v(" "),e._l(t.detailList,(function(t,r){return n("el-card",{key:r,staticClass:"box-card mb-15"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v(e._s(t.order+"."+t.title))])]),e._v(" "),e._l(t.option,(function(r,s){return n("div",{key:s,staticClass:"text item"},["input"===t.topic?n("span",[e._v(e._s(t.content))]):n("span",[e._v(e._s(r.name+"."+r.content))])])}))],2)}))],2)})),0)])])}),o=[],c={name:"DashComponent",props:{personName:{type:String,required:!0},personId:{type:String,required:!0}},data:function(){return{dataList:[],isPdf:!0}},created:function(){this.getAnswerDetail()},methods:{getAnswerDetail:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.localLoading(),e.prev=1,e.next=4,this.$api.question.getMergeDetail({personId:this.personId});case 4:n=e.sent,t.close(),n.result?this.dataList=n.data:this.$message.error(n.message),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),t.close();case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));function t(){return e.apply(this,arguments)}return t}(),exportPdf:function(){this.$getPdf("answerDetail",this.personName+"的调查问卷")},localLoading:function(){var e=this.$loading({lock:!0});return e}}},u=c,l=(n("c101"),n("2877")),p=Object(l["a"])(u,i,o,!1,null,"299b7e6f",null),d=p.exports,h={name:"Dashboard",components:{DashComponent:d},data:function(){return{queryForm:{person:[]},page:{pageSizes:[10,20,30,40],currentPage:1,total:0,pageSize:10},data:[],rolesList:[],loading:!1,option:{emptyText:"暂无数据",columnBtn:!1,refreshBtn:!1,addBtn:!1,delBtn:!1,editBtn:!1,border:!0,stripe:!0,selection:!1,indexFixed:!1,selectionFixed:!1,align:"center",menuAlign:"center",menuWidth:200,column:[{label:"用户",prop:"person",overHidden:!0,formatter:function(e,t){return t?t.name:null}},{label:"身份",prop:"role",overHidden:!0,formatter:function(e,t){return e.person.role.chinese}},{label:"问卷",prop:"question",overHidden:!0,width:"450",formatter:function(e,t){var n=[];return t.length>0?(t.forEach((function(e){n.push(e.name)})),n.join("、")):""}},{label:"问卷",prop:"createTime",overHidden:!0}]},personList:[],drawerVisible:!1,show:!1,personId:"",personName:""}},created:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.query();case 2:return e.next=4,this.getAllPerson();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getAllPerson:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.sys.getAllPerson({});case 2:t=e.sent,t.result?this.personList=t.data:this.$message.error(t.message);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),search:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.page.currentPage=1,e.next=3,this.query();case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),query:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.$api.question.getAnswerMerge({person:this.queryForm.person,pageSize:this.page.pageSize,pageNum:this.page.currentPage});case 4:t=e.sent,t.result?(this.page.total=t.total,this.data=t.data):this.$message.error(t.message),this.loading=!1,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),this.loading=!1;case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));function t(){return e.apply(this,arguments)}return t}(),sizeChange:function(e){this.page.currentPage=1,this.page.pageSize=e,this.query()},currentChange:function(e){this.page.currentPage=e,this.query()},detail:function(e){var t=this;this.personId=e.person._id,this.personName=e.person.name,this.drawerVisible=!0,this.show=!1,this.$nextTick((function(){t.show=!0}))},closeOption:function(){this.drawerVisible=!1},remove:function(e){var t=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0,confirmButtonClass:"el-button--danger"}).then(Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.loading=!0,console.log(e),n.next=4,t.$api.question.deleteAnswer({personId:e.person._id,questionId:e.question._id,questionTypeId:e.questionType._id});case 4:if(r=n.sent,t.loading=!1,!r.result){n.next=12;break}return t.$message.success("删除成功"),n.next=10,t.query();case 10:n.next=13;break;case 12:t.$message.error(r.message);case 13:case"end":return n.stop()}}),n)})))).catch((function(){t.$message({type:"info",message:"已取消删除"}),t.loading=!1}))},localLoading:function(){var e=this.$loading({lock:!0});return e}}},f=h,g=Object(l["a"])(f,r,s,!1,null,"647b7e45",null);t["default"]=g.exports},c101:function(e,t,n){"use strict";var r=n("de61"),s=n.n(r);s.a},de61:function(e,t,n){}}]);